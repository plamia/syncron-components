{"ast":null,"code":"import _regeneratorRuntime from \"/Users/plamenakichukova/syncron-sdk-components/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/regenerator/index.js\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport \"core-js/modules/es.reflect.get.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.freeze.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4;\n\nimport \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get.apply(this, arguments);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport deprecate from 'util-deprecate';\nimport dedent from 'ts-dedent';\nimport global from 'global';\nimport { CURRENT_STORY_WAS_SET, IGNORED_EXCEPTION, PRELOAD_STORIES, PREVIEW_KEYDOWN, SET_CURRENT_STORY, SET_STORIES, STORY_ARGS_UPDATED, STORY_CHANGED, STORY_ERRORED, STORY_MISSING, STORY_PREPARED, STORY_RENDER_PHASE_CHANGED, STORY_SPECIFIED, STORY_THREW_EXCEPTION, STORY_UNCHANGED, UPDATE_QUERY_PARAMS } from '@storybook/core-events';\nimport { logger } from '@storybook/client-logger';\nimport { Preview } from './Preview';\nimport { UrlStore } from './UrlStore';\nimport { WebView } from './WebView';\nimport { PREPARE_ABORTED, StoryRender } from './StoryRender';\nimport { DocsRender } from './DocsRender';\nvar globalWindow = global.window;\n\nfunction focusInInput(event) {\n  var target = event.target;\n  return /input|textarea/i.test(target.tagName) || target.getAttribute('contenteditable') !== null;\n}\n\nexport var PreviewWeb = /*#__PURE__*/function (_Preview) {\n  _inherits(PreviewWeb, _Preview);\n\n  var _super = _createSuper(PreviewWeb);\n\n  function PreviewWeb() {\n    var _this;\n\n    _classCallCheck(this, PreviewWeb);\n\n    _this = _super.call(this);\n    _this.urlStore = void 0;\n    _this.view = void 0;\n    _this.previewEntryError = void 0;\n    _this.currentSelection = void 0;\n    _this.currentRender = void 0;\n    _this.view = new WebView();\n    _this.urlStore = new UrlStore(); // Add deprecated APIs for back-compat\n    // @ts-ignore\n\n    _this.storyStore.getSelection = deprecate(function () {\n      return _this.urlStore.selection;\n    }, dedent(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n        `__STORYBOOK_STORY_STORE__.getSelection()` is deprecated and will be removed in 7.0.\\n  \\n        To get the current selection, use the `useStoryContext()` hook from `@storybook/addons`.\\n      \"], [\"\\n        \\\\`__STORYBOOK_STORY_STORE__.getSelection()\\\\` is deprecated and will be removed in 7.0.\\n  \\n        To get the current selection, use the \\\\`useStoryContext()\\\\` hook from \\\\`@storybook/addons\\\\`.\\n      \"]))));\n    return _this;\n  }\n\n  _createClass(PreviewWeb, [{\n    key: \"setupListeners\",\n    value: function setupListeners() {\n      _get(_getPrototypeOf(PreviewWeb.prototype), \"setupListeners\", this).call(this);\n\n      globalWindow.onkeydown = this.onKeydown.bind(this);\n      this.channel.on(SET_CURRENT_STORY, this.onSetCurrentStory.bind(this));\n      this.channel.on(UPDATE_QUERY_PARAMS, this.onUpdateQueryParams.bind(this));\n      this.channel.on(PRELOAD_STORIES, this.onPreloadStories.bind(this));\n    }\n  }, {\n    key: \"initializeWithProjectAnnotations\",\n    value: function initializeWithProjectAnnotations(projectAnnotations) {\n      var _this2 = this;\n\n      return _get(_getPrototypeOf(PreviewWeb.prototype), \"initializeWithProjectAnnotations\", this).call(this, projectAnnotations).then(function () {\n        return _this2.setInitialGlobals();\n      });\n    }\n  }, {\n    key: \"setInitialGlobals\",\n    value: function () {\n      var _setInitialGlobals = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _ref, globals;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _ref = this.urlStore.selectionSpecifier || {}, globals = _ref.globals;\n\n                if (globals) {\n                  this.storyStore.globals.updateFromPersisted(globals);\n                }\n\n                this.emitGlobals();\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function setInitialGlobals() {\n        return _setInitialGlobals.apply(this, arguments);\n      }\n\n      return setInitialGlobals;\n    }() // If initialization gets as far as the story index, this function runs.\n\n  }, {\n    key: \"initializeWithStoryIndex\",\n    value: function initializeWithStoryIndex(storyIndex) {\n      var _this3 = this;\n\n      return _get(_getPrototypeOf(PreviewWeb.prototype), \"initializeWithStoryIndex\", this).call(this, storyIndex).then(function () {\n        var _global$FEATURES;\n\n        if (!((_global$FEATURES = global.FEATURES) !== null && _global$FEATURES !== void 0 && _global$FEATURES.storyStoreV7)) {\n          _this3.channel.emit(SET_STORIES, _this3.storyStore.getSetStoriesPayload());\n        }\n\n        return _this3.selectSpecifiedStory();\n      });\n    } // Use the selection specifier to choose a story, then render it\n\n  }, {\n    key: \"selectSpecifiedStory\",\n    value: function () {\n      var _selectSpecifiedStory = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var _this$urlStore$select, storySpecifier, viewMode, args, storyId;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.urlStore.selectionSpecifier) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                this.renderMissingStory();\n                return _context2.abrupt(\"return\");\n\n              case 3:\n                _this$urlStore$select = this.urlStore.selectionSpecifier, storySpecifier = _this$urlStore$select.storySpecifier, viewMode = _this$urlStore$select.viewMode, args = _this$urlStore$select.args;\n                storyId = this.storyStore.storyIndex.storyIdFromSpecifier(storySpecifier);\n\n                if (storyId) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                if (storySpecifier === '*') {\n                  this.renderStoryLoadingException(storySpecifier, new Error(dedent(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n            Couldn't find any stories in your Storybook.\\n            - Please check your stories field of your main.js config.\\n            - Also check the browser console and terminal for error messages.\\n          \"])))));\n                } else {\n                  this.renderStoryLoadingException(storySpecifier, new Error(dedent(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n            Couldn't find story matching '\", \"'.\\n            - Are you sure a story with that id exists?\\n            - Please check your stories field of your main.js config.\\n            - Also check the browser console and terminal for error messages.\\n          \"])), storySpecifier)));\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 8:\n                this.urlStore.setSelection({\n                  storyId: storyId,\n                  viewMode: viewMode\n                });\n                this.channel.emit(STORY_SPECIFIED, this.urlStore.selection);\n                this.channel.emit(CURRENT_STORY_WAS_SET, this.urlStore.selection);\n                _context2.next = 13;\n                return this.renderSelection({\n                  persistedArgs: args\n                });\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function selectSpecifiedStory() {\n        return _selectSpecifiedStory.apply(this, arguments);\n      }\n\n      return selectSpecifiedStory;\n    }() // EVENT HANDLERS\n    // This happens when a config file gets reloaded\n\n  }, {\n    key: \"onGetProjectAnnotationsChanged\",\n    value: function () {\n      var _onGetProjectAnnotationsChanged = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref2) {\n        var getProjectAnnotations;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                getProjectAnnotations = _ref2.getProjectAnnotations;\n                _context3.next = 3;\n                return _get(_getPrototypeOf(PreviewWeb.prototype), \"onGetProjectAnnotationsChanged\", this).call(this, {\n                  getProjectAnnotations: getProjectAnnotations\n                });\n\n              case 3:\n                this.renderSelection();\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function onGetProjectAnnotationsChanged(_x) {\n        return _onGetProjectAnnotationsChanged.apply(this, arguments);\n      }\n\n      return onGetProjectAnnotationsChanged;\n    }() // This happens when a glob gets HMR-ed\n\n  }, {\n    key: \"onStoriesChanged\",\n    value: function () {\n      var _onStoriesChanged = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(_ref3) {\n        var _global$FEATURES2;\n\n        var importFn, storyIndex;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                importFn = _ref3.importFn, storyIndex = _ref3.storyIndex;\n\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onStoriesChanged\", this).call(this, {\n                  importFn: importFn,\n                  storyIndex: storyIndex\n                });\n\n                if ((_global$FEATURES2 = global.FEATURES) !== null && _global$FEATURES2 !== void 0 && _global$FEATURES2.storyStoreV7) {\n                  _context4.next = 9;\n                  break;\n                }\n\n                _context4.t0 = this.channel;\n                _context4.t1 = SET_STORIES;\n                _context4.next = 7;\n                return this.storyStore.getSetStoriesPayload();\n\n              case 7:\n                _context4.t2 = _context4.sent;\n\n                _context4.t0.emit.call(_context4.t0, _context4.t1, _context4.t2);\n\n              case 9:\n                if (!this.urlStore.selection) {\n                  _context4.next = 14;\n                  break;\n                }\n\n                _context4.next = 12;\n                return this.renderSelection();\n\n              case 12:\n                _context4.next = 16;\n                break;\n\n              case 14:\n                _context4.next = 16;\n                return this.selectSpecifiedStory();\n\n              case 16:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function onStoriesChanged(_x2) {\n        return _onStoriesChanged.apply(this, arguments);\n      }\n\n      return onStoriesChanged;\n    }()\n  }, {\n    key: \"onKeydown\",\n    value: function onKeydown(event) {\n      var _this$currentRender;\n\n      if (!((_this$currentRender = this.currentRender) !== null && _this$currentRender !== void 0 && _this$currentRender.disableKeyListeners) && !focusInInput(event)) {\n        // We have to pick off the keys of the event that we need on the other side\n        var altKey = event.altKey,\n            ctrlKey = event.ctrlKey,\n            metaKey = event.metaKey,\n            shiftKey = event.shiftKey,\n            key = event.key,\n            code = event.code,\n            keyCode = event.keyCode;\n        this.channel.emit(PREVIEW_KEYDOWN, {\n          event: {\n            altKey: altKey,\n            ctrlKey: ctrlKey,\n            metaKey: metaKey,\n            shiftKey: shiftKey,\n            key: key,\n            code: code,\n            keyCode: keyCode\n          }\n        });\n      }\n    }\n  }, {\n    key: \"onSetCurrentStory\",\n    value: function onSetCurrentStory(selection) {\n      this.urlStore.setSelection(Object.assign({\n        viewMode: 'story'\n      }, selection));\n      this.channel.emit(CURRENT_STORY_WAS_SET, this.urlStore.selection);\n      this.renderSelection();\n    }\n  }, {\n    key: \"onUpdateQueryParams\",\n    value: function onUpdateQueryParams(queryParams) {\n      this.urlStore.setQueryParams(queryParams);\n    }\n  }, {\n    key: \"onUpdateGlobals\",\n    value: function () {\n      var _onUpdateGlobals = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(_ref4) {\n        var globals;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                globals = _ref4.globals;\n\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onUpdateGlobals\", this).call(this, {\n                  globals: globals\n                });\n\n                if (!(this.currentRender instanceof DocsRender)) {\n                  _context5.next = 5;\n                  break;\n                }\n\n                _context5.next = 5;\n                return this.currentRender.rerender(true);\n\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function onUpdateGlobals(_x3) {\n        return _onUpdateGlobals.apply(this, arguments);\n      }\n\n      return onUpdateGlobals;\n    }()\n  }, {\n    key: \"onUpdateArgs\",\n    value: function () {\n      var _onUpdateArgs = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(_ref5) {\n        var storyId, updatedArgs;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                storyId = _ref5.storyId, updatedArgs = _ref5.updatedArgs;\n\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onUpdateArgs\", this).call(this, {\n                  storyId: storyId,\n                  updatedArgs: updatedArgs\n                }); // NOTE: we aren't checking to see the story args are targetted at the \"right\" story.\n                // This is because we may render >1 story on the page and there is no easy way to keep track\n                // of which ones were rendered by the docs page.\n                // However, in `modernInlineRender`, the individual stories track their own events as they\n                // each call `renderStoryToElement` below.\n\n\n                if (!(this.currentRender instanceof DocsRender)) {\n                  _context6.next = 5;\n                  break;\n                }\n\n                _context6.next = 5;\n                return this.currentRender.rerender(false);\n\n              case 5:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function onUpdateArgs(_x4) {\n        return _onUpdateArgs.apply(this, arguments);\n      }\n\n      return onUpdateArgs;\n    }()\n  }, {\n    key: \"onPreloadStories\",\n    value: function () {\n      var _onPreloadStories = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(ids) {\n        var _this4 = this;\n\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return Promise.all(ids.map(function (id) {\n                  return _this4.storyStore.loadStory({\n                    storyId: id\n                  });\n                }));\n\n              case 2:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }));\n\n      function onPreloadStories(_x5) {\n        return _onPreloadStories.apply(this, arguments);\n      }\n\n      return onPreloadStories;\n    }() // RENDERING\n    // We can either have:\n    // - a story selected in \"story\" viewMode,\n    //     in which case we render it to the root element, OR\n    // - a story selected in \"docs\" viewMode,\n    //     in which case we render the docsPage for that story\n\n  }, {\n    key: \"renderSelection\",\n    value: function () {\n      var _renderSelection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n        var _this$currentSelectio,\n            _this$currentSelectio2,\n            _lastRender,\n            _this5 = this,\n            _global$FEATURES3;\n\n        var _ref6,\n            persistedArgs,\n            selection,\n            storyId,\n            storyIdChanged,\n            viewModeChanged,\n            lastSelection,\n            lastRender,\n            storyRender,\n            implementationChanged,\n            _storyRender$context,\n            parameters,\n            initialArgs,\n            argTypes,\n            args,\n            _args8 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _ref6 = _args8.length > 0 && _args8[0] !== undefined ? _args8[0] : {}, persistedArgs = _ref6.persistedArgs;\n                selection = this.urlStore.selection;\n\n                if (selection) {\n                  _context8.next = 4;\n                  break;\n                }\n\n                throw new Error('Cannot render story as no selection was made');\n\n              case 4:\n                storyId = selection.storyId;\n                storyIdChanged = ((_this$currentSelectio = this.currentSelection) === null || _this$currentSelectio === void 0 ? void 0 : _this$currentSelectio.storyId) !== storyId;\n                viewModeChanged = ((_this$currentSelectio2 = this.currentSelection) === null || _this$currentSelectio2 === void 0 ? void 0 : _this$currentSelectio2.viewMode) !== selection.viewMode; // Show a spinner while we load the next story\n\n                if (selection.viewMode === 'story') {\n                  this.view.showPreparingStory({\n                    immediate: viewModeChanged\n                  });\n                } else {\n                  this.view.showPreparingDocs();\n                }\n\n                lastSelection = this.currentSelection;\n                lastRender = this.currentRender; // If the last render is still preparing, let's drop it right now. Either\n                //   (a) it is a different story, which means we would drop it later, OR\n                //   (b) it is the *same* story, in which case we will resolve our own .prepare() at the\n                //       same moment anyway, and we should just \"take over\" the rendering.\n                // (We can't tell which it is yet, because it is possible that an HMR is going on and\n                //  even though the storyId is the same, the story itself is not).\n\n                if (!((_lastRender = lastRender) !== null && _lastRender !== void 0 && _lastRender.isPreparing())) {\n                  _context8.next = 14;\n                  break;\n                }\n\n                _context8.next = 13;\n                return this.teardownRender(lastRender);\n\n              case 13:\n                lastRender = null;\n\n              case 14:\n                storyRender = new StoryRender(this.channel, this.storyStore, function () {\n                  // At the start of renderToDOM we make the story visible (see note in WebView)\n                  _this5.view.showStoryDuringRender();\n\n                  return _this5.renderToDOM.apply(_this5, arguments);\n                }, this.mainStoryCallbacks(storyId), storyId, 'story'); // We need to store this right away, so if the story changes during\n                // the async `.prepare()` below, we can (potentially) cancel it\n\n                this.currentSelection = selection; // Note this may be replaced by a docsRender after preparing\n\n                this.currentRender = storyRender;\n                _context8.prev = 17;\n                _context8.next = 20;\n                return storyRender.prepare();\n\n              case 20:\n                _context8.next = 29;\n                break;\n\n              case 22:\n                _context8.prev = 22;\n                _context8.t0 = _context8[\"catch\"](17);\n\n                if (!(_context8.t0 !== PREPARE_ABORTED)) {\n                  _context8.next = 28;\n                  break;\n                }\n\n                _context8.next = 27;\n                return this.teardownRender(lastRender);\n\n              case 27:\n                this.renderStoryLoadingException(storyId, _context8.t0);\n\n              case 28:\n                return _context8.abrupt(\"return\");\n\n              case 29:\n                implementationChanged = !storyIdChanged && !storyRender.isEqual(lastRender);\n                if (persistedArgs) this.storyStore.args.updateFromPersisted(storyRender.story, persistedArgs);\n                _storyRender$context = storyRender.context(), parameters = _storyRender$context.parameters, initialArgs = _storyRender$context.initialArgs, argTypes = _storyRender$context.argTypes, args = _storyRender$context.args; // Don't re-render the story if nothing has changed to justify it\n\n                if (!(lastRender && !storyIdChanged && !implementationChanged && !viewModeChanged)) {\n                  _context8.next = 37;\n                  break;\n                }\n\n                this.currentRender = lastRender;\n                this.channel.emit(STORY_UNCHANGED, storyId);\n                this.view.showMain();\n                return _context8.abrupt(\"return\");\n\n              case 37:\n                _context8.next = 39;\n                return this.teardownRender(lastRender, {\n                  viewModeChanged: viewModeChanged\n                });\n\n              case 39:\n                // If we are rendering something new (as opposed to re-rendering the same or first story), emit\n                if (lastSelection && (storyIdChanged || viewModeChanged)) {\n                  this.channel.emit(STORY_CHANGED, storyId);\n                }\n\n                if ((_global$FEATURES3 = global.FEATURES) !== null && _global$FEATURES3 !== void 0 && _global$FEATURES3.storyStoreV7) {\n                  this.channel.emit(STORY_PREPARED, {\n                    id: storyId,\n                    parameters: parameters,\n                    initialArgs: initialArgs,\n                    argTypes: argTypes,\n                    args: args\n                  });\n                } // For v6 mode / compatibility\n                // If the implementation changed, or args were persisted, the args may have changed,\n                // and the STORY_PREPARED event above may not be respected.\n\n\n                if (implementationChanged || persistedArgs) {\n                  this.channel.emit(STORY_ARGS_UPDATED, {\n                    storyId: storyId,\n                    args: args\n                  });\n                }\n\n                if (selection.viewMode === 'docs' || parameters.docsOnly) {\n                  this.currentRender = DocsRender.fromStoryRender(storyRender);\n                  this.currentRender.renderToElement(this.view.prepareForDocs(), this.renderStoryToElement.bind(this));\n                } else {\n                  this.storyRenders.push(storyRender);\n                  this.currentRender.renderToElement(this.view.prepareForStory(storyRender.story));\n                }\n\n              case 43:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this, [[17, 22]]);\n      }));\n\n      function renderSelection() {\n        return _renderSelection.apply(this, arguments);\n      }\n\n      return renderSelection;\n    }() // Used by docs' modernInlineRender to render a story to a given element\n    // Note this short-circuits the `prepare()` phase of the StoryRender,\n    // main to be consistent with the previous behaviour. In the future,\n    // we will change it to go ahead and load the story, which will end up being\n    // \"instant\", although async.\n\n  }, {\n    key: \"renderStoryToElement\",\n    value: function renderStoryToElement(story, element) {\n      var _this6 = this;\n\n      var render = new StoryRender(this.channel, this.storyStore, this.renderToDOM, this.inlineStoryCallbacks(story.id), story.id, 'docs', story);\n      render.renderToElement(element);\n      this.storyRenders.push(render);\n      return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return _this6.teardownRender(render);\n\n              case 2:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }));\n    }\n  }, {\n    key: \"teardownRender\",\n    value: function () {\n      var _teardownRender = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10(render) {\n        var _ref8,\n            viewModeChanged,\n            _args10 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _ref8 = _args10.length > 1 && _args10[1] !== undefined ? _args10[1] : {}, viewModeChanged = _ref8.viewModeChanged;\n                this.storyRenders = this.storyRenders.filter(function (r) {\n                  return r !== render;\n                });\n                _context10.next = 4;\n                return render === null || render === void 0 ? void 0 : render.teardown({\n                  viewModeChanged: viewModeChanged\n                });\n\n              case 4:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function teardownRender(_x6) {\n        return _teardownRender.apply(this, arguments);\n      }\n\n      return teardownRender;\n    }() // API\n\n  }, {\n    key: \"extract\",\n    value: function () {\n      var _extract = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11(options) {\n        var _global$FEATURES4;\n\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                if (!this.previewEntryError) {\n                  _context11.next = 2;\n                  break;\n                }\n\n                throw this.previewEntryError;\n\n              case 2:\n                if (this.storyStore.projectAnnotations) {\n                  _context11.next = 4;\n                  break;\n                }\n\n                throw new Error(dedent(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your `preview.js`? Check your Storybook's browser console for errors.\"], [\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your \\\\`preview.js\\\\`? Check your Storybook's browser console for errors.\"]))));\n\n              case 4:\n                if (!((_global$FEATURES4 = global.FEATURES) !== null && _global$FEATURES4 !== void 0 && _global$FEATURES4.storyStoreV7)) {\n                  _context11.next = 7;\n                  break;\n                }\n\n                _context11.next = 7;\n                return this.storyStore.cacheAllCSFFiles();\n\n              case 7:\n                return _context11.abrupt(\"return\", this.storyStore.extract(options));\n\n              case 8:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n\n      function extract(_x7) {\n        return _extract.apply(this, arguments);\n      }\n\n      return extract;\n    }() // UTILITIES\n\n  }, {\n    key: \"mainStoryCallbacks\",\n    value: function mainStoryCallbacks(storyId) {\n      var _this7 = this;\n\n      return {\n        showMain: function showMain() {\n          return _this7.view.showMain();\n        },\n        showError: function showError(err) {\n          return _this7.renderError(storyId, err);\n        },\n        showException: function showException(err) {\n          return _this7.renderException(storyId, err);\n        }\n      };\n    }\n  }, {\n    key: \"inlineStoryCallbacks\",\n    value: function inlineStoryCallbacks(storyId) {\n      return {\n        showMain: function showMain() {},\n        showError: function showError(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        },\n        showException: function showException(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        }\n      };\n    }\n  }, {\n    key: \"renderPreviewEntryError\",\n    value: function renderPreviewEntryError(reason, err) {\n      _get(_getPrototypeOf(PreviewWeb.prototype), \"renderPreviewEntryError\", this).call(this, reason, err);\n\n      this.view.showErrorDisplay(err);\n    }\n  }, {\n    key: \"renderMissingStory\",\n    value: function renderMissingStory() {\n      this.view.showNoPreview();\n      this.channel.emit(STORY_MISSING);\n    }\n  }, {\n    key: \"renderStoryLoadingException\",\n    value: function renderStoryLoadingException(storySpecifier, err) {\n      logger.error(\"Unable to load story '\".concat(storySpecifier, \"':\"));\n      logger.error(err);\n      this.view.showErrorDisplay(err);\n      this.channel.emit(STORY_MISSING, storySpecifier);\n    } // renderException is used if we fail to render the story and it is uncaught by the app layer\n\n  }, {\n    key: \"renderException\",\n    value: function renderException(storyId, err) {\n      this.channel.emit(STORY_THREW_EXCEPTION, err);\n      this.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n        newPhase: 'errored',\n        storyId: storyId\n      }); // Ignored exceptions exist for control flow purposes, and are typically handled elsewhere.\n\n      if (err !== IGNORED_EXCEPTION) {\n        this.view.showErrorDisplay(err);\n        logger.error(\"Error rendering story '\".concat(storyId, \"':\"));\n        logger.error(err);\n      }\n    } // renderError is used by the various app layers to inform the user they have done something\n    // wrong -- for instance returned the wrong thing from a story\n\n  }, {\n    key: \"renderError\",\n    value: function renderError(storyId, _ref9) {\n      var title = _ref9.title,\n          description = _ref9.description;\n      logger.error(\"Error rendering story \".concat(title, \": \").concat(description));\n      this.channel.emit(STORY_ERRORED, {\n        title: title,\n        description: description\n      });\n      this.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n        newPhase: 'errored',\n        storyId: storyId\n      });\n      this.view.showErrorDisplay({\n        message: title,\n        stack: description\n      });\n    }\n  }]);\n\n  return PreviewWeb;\n}(Preview);","map":{"version":3,"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_templateObject","_templateObject2","_templateObject3","_templateObject4","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_taggedTemplateLiteral","strings","raw","slice","Object","freeze","defineProperties","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","defineProperty","_createClass","protoProps","staticProps","_get","Reflect","get","property","receiver","base","_superPropBase","desc","getOwnPropertyDescriptor","call","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","deprecate","dedent","global","CURRENT_STORY_WAS_SET","IGNORED_EXCEPTION","PRELOAD_STORIES","PREVIEW_KEYDOWN","SET_CURRENT_STORY","SET_STORIES","STORY_ARGS_UPDATED","STORY_CHANGED","STORY_ERRORED","STORY_MISSING","STORY_PREPARED","STORY_RENDER_PHASE_CHANGED","STORY_SPECIFIED","STORY_THREW_EXCEPTION","STORY_UNCHANGED","UPDATE_QUERY_PARAMS","logger","Preview","UrlStore","WebView","PREPARE_ABORTED","StoryRender","DocsRender","globalWindow","window","focusInInput","event","test","tagName","getAttribute","PreviewWeb","_Preview","_super","_this","urlStore","view","previewEntryError","currentSelection","currentRender","storyStore","getSelection","selection","setupListeners","onkeydown","onKeydown","bind","channel","on","onSetCurrentStory","onUpdateQueryParams","onPreloadStories","initializeWithProjectAnnotations","projectAnnotations","_this2","setInitialGlobals","_setInitialGlobals","mark","_callee","_ref","globals","wrap","_callee$","_context","prev","next","selectionSpecifier","updateFromPersisted","emitGlobals","stop","initializeWithStoryIndex","storyIndex","_this3","_global$FEATURES","FEATURES","storyStoreV7","emit","getSetStoriesPayload","selectSpecifiedStory","_selectSpecifiedStory","_callee2","_this$urlStore$select","storySpecifier","viewMode","storyId","_callee2$","_context2","renderMissingStory","abrupt","storyIdFromSpecifier","renderStoryLoadingException","Error","setSelection","renderSelection","persistedArgs","_onGetProjectAnnotationsChanged","_callee3","_ref2","getProjectAnnotations","_callee3$","_context3","onGetProjectAnnotationsChanged","_x","_onStoriesChanged","_callee4","_ref3","_global$FEATURES2","importFn","_callee4$","_context4","t0","t1","t2","sent","onStoriesChanged","_x2","_this$currentRender","disableKeyListeners","altKey","ctrlKey","metaKey","shiftKey","code","keyCode","assign","queryParams","setQueryParams","_onUpdateGlobals","_callee5","_ref4","_callee5$","_context5","rerender","onUpdateGlobals","_x3","_onUpdateArgs","_callee6","_ref5","updatedArgs","_callee6$","_context6","onUpdateArgs","_x4","_onPreloadStories","_callee7","ids","_this4","_callee7$","_context7","all","map","id","loadStory","_x5","_renderSelection","_callee8","_this$currentSelectio","_this$currentSelectio2","_lastRender","_this5","_global$FEATURES3","_ref6","storyIdChanged","viewModeChanged","lastSelection","lastRender","storyRender","implementationChanged","_storyRender$context","parameters","initialArgs","argTypes","_args8","_callee8$","_context8","showPreparingStory","immediate","showPreparingDocs","isPreparing","teardownRender","showStoryDuringRender","renderToDOM","mainStoryCallbacks","prepare","isEqual","story","context","showMain","docsOnly","fromStoryRender","renderToElement","prepareForDocs","renderStoryToElement","storyRenders","push","prepareForStory","element","_this6","render","inlineStoryCallbacks","_callee9","_callee9$","_context9","_teardownRender","_callee10","_ref8","_args10","_callee10$","_context10","filter","r","teardown","_x6","_extract","_callee11","options","_global$FEATURES4","_callee11$","_context11","cacheAllCSFFiles","extract","_x7","_this7","showError","renderError","showException","renderException","concat","renderPreviewEntryError","reason","showErrorDisplay","showNoPreview","newPhase","_ref9","title","description","message","stack"],"sources":["/Users/plamenakichukova/syncron-sdk-components/node_modules/@storybook/preview-web/dist/esm/PreviewWeb.js"],"sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport \"core-js/modules/es.reflect.get.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.freeze.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4;\n\nimport \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return _get.apply(this, arguments); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport deprecate from 'util-deprecate';\nimport dedent from 'ts-dedent';\nimport global from 'global';\nimport { CURRENT_STORY_WAS_SET, IGNORED_EXCEPTION, PRELOAD_STORIES, PREVIEW_KEYDOWN, SET_CURRENT_STORY, SET_STORIES, STORY_ARGS_UPDATED, STORY_CHANGED, STORY_ERRORED, STORY_MISSING, STORY_PREPARED, STORY_RENDER_PHASE_CHANGED, STORY_SPECIFIED, STORY_THREW_EXCEPTION, STORY_UNCHANGED, UPDATE_QUERY_PARAMS } from '@storybook/core-events';\nimport { logger } from '@storybook/client-logger';\nimport { Preview } from './Preview';\nimport { UrlStore } from './UrlStore';\nimport { WebView } from './WebView';\nimport { PREPARE_ABORTED, StoryRender } from './StoryRender';\nimport { DocsRender } from './DocsRender';\nvar globalWindow = global.window;\n\nfunction focusInInput(event) {\n  var target = event.target;\n  return /input|textarea/i.test(target.tagName) || target.getAttribute('contenteditable') !== null;\n}\n\nexport var PreviewWeb = /*#__PURE__*/function (_Preview) {\n  _inherits(PreviewWeb, _Preview);\n\n  var _super = _createSuper(PreviewWeb);\n\n  function PreviewWeb() {\n    var _this;\n\n    _classCallCheck(this, PreviewWeb);\n\n    _this = _super.call(this);\n    _this.urlStore = void 0;\n    _this.view = void 0;\n    _this.previewEntryError = void 0;\n    _this.currentSelection = void 0;\n    _this.currentRender = void 0;\n    _this.view = new WebView();\n    _this.urlStore = new UrlStore(); // Add deprecated APIs for back-compat\n    // @ts-ignore\n\n    _this.storyStore.getSelection = deprecate(function () {\n      return _this.urlStore.selection;\n    }, dedent(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n        `__STORYBOOK_STORY_STORE__.getSelection()` is deprecated and will be removed in 7.0.\\n  \\n        To get the current selection, use the `useStoryContext()` hook from `@storybook/addons`.\\n      \"], [\"\\n        \\\\`__STORYBOOK_STORY_STORE__.getSelection()\\\\` is deprecated and will be removed in 7.0.\\n  \\n        To get the current selection, use the \\\\`useStoryContext()\\\\` hook from \\\\`@storybook/addons\\\\`.\\n      \"]))));\n    return _this;\n  }\n\n  _createClass(PreviewWeb, [{\n    key: \"setupListeners\",\n    value: function setupListeners() {\n      _get(_getPrototypeOf(PreviewWeb.prototype), \"setupListeners\", this).call(this);\n\n      globalWindow.onkeydown = this.onKeydown.bind(this);\n      this.channel.on(SET_CURRENT_STORY, this.onSetCurrentStory.bind(this));\n      this.channel.on(UPDATE_QUERY_PARAMS, this.onUpdateQueryParams.bind(this));\n      this.channel.on(PRELOAD_STORIES, this.onPreloadStories.bind(this));\n    }\n  }, {\n    key: \"initializeWithProjectAnnotations\",\n    value: function initializeWithProjectAnnotations(projectAnnotations) {\n      var _this2 = this;\n\n      return _get(_getPrototypeOf(PreviewWeb.prototype), \"initializeWithProjectAnnotations\", this).call(this, projectAnnotations).then(function () {\n        return _this2.setInitialGlobals();\n      });\n    }\n  }, {\n    key: \"setInitialGlobals\",\n    value: function () {\n      var _setInitialGlobals = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _ref, globals;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _ref = this.urlStore.selectionSpecifier || {}, globals = _ref.globals;\n\n                if (globals) {\n                  this.storyStore.globals.updateFromPersisted(globals);\n                }\n\n                this.emitGlobals();\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function setInitialGlobals() {\n        return _setInitialGlobals.apply(this, arguments);\n      }\n\n      return setInitialGlobals;\n    }() // If initialization gets as far as the story index, this function runs.\n\n  }, {\n    key: \"initializeWithStoryIndex\",\n    value: function initializeWithStoryIndex(storyIndex) {\n      var _this3 = this;\n\n      return _get(_getPrototypeOf(PreviewWeb.prototype), \"initializeWithStoryIndex\", this).call(this, storyIndex).then(function () {\n        var _global$FEATURES;\n\n        if (!((_global$FEATURES = global.FEATURES) !== null && _global$FEATURES !== void 0 && _global$FEATURES.storyStoreV7)) {\n          _this3.channel.emit(SET_STORIES, _this3.storyStore.getSetStoriesPayload());\n        }\n\n        return _this3.selectSpecifiedStory();\n      });\n    } // Use the selection specifier to choose a story, then render it\n\n  }, {\n    key: \"selectSpecifiedStory\",\n    value: function () {\n      var _selectSpecifiedStory = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var _this$urlStore$select, storySpecifier, viewMode, args, storyId;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.urlStore.selectionSpecifier) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                this.renderMissingStory();\n                return _context2.abrupt(\"return\");\n\n              case 3:\n                _this$urlStore$select = this.urlStore.selectionSpecifier, storySpecifier = _this$urlStore$select.storySpecifier, viewMode = _this$urlStore$select.viewMode, args = _this$urlStore$select.args;\n                storyId = this.storyStore.storyIndex.storyIdFromSpecifier(storySpecifier);\n\n                if (storyId) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                if (storySpecifier === '*') {\n                  this.renderStoryLoadingException(storySpecifier, new Error(dedent(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n            Couldn't find any stories in your Storybook.\\n            - Please check your stories field of your main.js config.\\n            - Also check the browser console and terminal for error messages.\\n          \"])))));\n                } else {\n                  this.renderStoryLoadingException(storySpecifier, new Error(dedent(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n            Couldn't find story matching '\", \"'.\\n            - Are you sure a story with that id exists?\\n            - Please check your stories field of your main.js config.\\n            - Also check the browser console and terminal for error messages.\\n          \"])), storySpecifier)));\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 8:\n                this.urlStore.setSelection({\n                  storyId: storyId,\n                  viewMode: viewMode\n                });\n                this.channel.emit(STORY_SPECIFIED, this.urlStore.selection);\n                this.channel.emit(CURRENT_STORY_WAS_SET, this.urlStore.selection);\n                _context2.next = 13;\n                return this.renderSelection({\n                  persistedArgs: args\n                });\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function selectSpecifiedStory() {\n        return _selectSpecifiedStory.apply(this, arguments);\n      }\n\n      return selectSpecifiedStory;\n    }() // EVENT HANDLERS\n    // This happens when a config file gets reloaded\n\n  }, {\n    key: \"onGetProjectAnnotationsChanged\",\n    value: function () {\n      var _onGetProjectAnnotationsChanged = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(_ref2) {\n        var getProjectAnnotations;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                getProjectAnnotations = _ref2.getProjectAnnotations;\n                _context3.next = 3;\n                return _get(_getPrototypeOf(PreviewWeb.prototype), \"onGetProjectAnnotationsChanged\", this).call(this, {\n                  getProjectAnnotations: getProjectAnnotations\n                });\n\n              case 3:\n                this.renderSelection();\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function onGetProjectAnnotationsChanged(_x) {\n        return _onGetProjectAnnotationsChanged.apply(this, arguments);\n      }\n\n      return onGetProjectAnnotationsChanged;\n    }() // This happens when a glob gets HMR-ed\n\n  }, {\n    key: \"onStoriesChanged\",\n    value: function () {\n      var _onStoriesChanged = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(_ref3) {\n        var _global$FEATURES2;\n\n        var importFn, storyIndex;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                importFn = _ref3.importFn, storyIndex = _ref3.storyIndex;\n\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onStoriesChanged\", this).call(this, {\n                  importFn: importFn,\n                  storyIndex: storyIndex\n                });\n\n                if ((_global$FEATURES2 = global.FEATURES) !== null && _global$FEATURES2 !== void 0 && _global$FEATURES2.storyStoreV7) {\n                  _context4.next = 9;\n                  break;\n                }\n\n                _context4.t0 = this.channel;\n                _context4.t1 = SET_STORIES;\n                _context4.next = 7;\n                return this.storyStore.getSetStoriesPayload();\n\n              case 7:\n                _context4.t2 = _context4.sent;\n\n                _context4.t0.emit.call(_context4.t0, _context4.t1, _context4.t2);\n\n              case 9:\n                if (!this.urlStore.selection) {\n                  _context4.next = 14;\n                  break;\n                }\n\n                _context4.next = 12;\n                return this.renderSelection();\n\n              case 12:\n                _context4.next = 16;\n                break;\n\n              case 14:\n                _context4.next = 16;\n                return this.selectSpecifiedStory();\n\n              case 16:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function onStoriesChanged(_x2) {\n        return _onStoriesChanged.apply(this, arguments);\n      }\n\n      return onStoriesChanged;\n    }()\n  }, {\n    key: \"onKeydown\",\n    value: function onKeydown(event) {\n      var _this$currentRender;\n\n      if (!((_this$currentRender = this.currentRender) !== null && _this$currentRender !== void 0 && _this$currentRender.disableKeyListeners) && !focusInInput(event)) {\n        // We have to pick off the keys of the event that we need on the other side\n        var altKey = event.altKey,\n            ctrlKey = event.ctrlKey,\n            metaKey = event.metaKey,\n            shiftKey = event.shiftKey,\n            key = event.key,\n            code = event.code,\n            keyCode = event.keyCode;\n        this.channel.emit(PREVIEW_KEYDOWN, {\n          event: {\n            altKey: altKey,\n            ctrlKey: ctrlKey,\n            metaKey: metaKey,\n            shiftKey: shiftKey,\n            key: key,\n            code: code,\n            keyCode: keyCode\n          }\n        });\n      }\n    }\n  }, {\n    key: \"onSetCurrentStory\",\n    value: function onSetCurrentStory(selection) {\n      this.urlStore.setSelection(Object.assign({\n        viewMode: 'story'\n      }, selection));\n      this.channel.emit(CURRENT_STORY_WAS_SET, this.urlStore.selection);\n      this.renderSelection();\n    }\n  }, {\n    key: \"onUpdateQueryParams\",\n    value: function onUpdateQueryParams(queryParams) {\n      this.urlStore.setQueryParams(queryParams);\n    }\n  }, {\n    key: \"onUpdateGlobals\",\n    value: function () {\n      var _onUpdateGlobals = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(_ref4) {\n        var globals;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                globals = _ref4.globals;\n\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onUpdateGlobals\", this).call(this, {\n                  globals: globals\n                });\n\n                if (!(this.currentRender instanceof DocsRender)) {\n                  _context5.next = 5;\n                  break;\n                }\n\n                _context5.next = 5;\n                return this.currentRender.rerender(true);\n\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function onUpdateGlobals(_x3) {\n        return _onUpdateGlobals.apply(this, arguments);\n      }\n\n      return onUpdateGlobals;\n    }()\n  }, {\n    key: \"onUpdateArgs\",\n    value: function () {\n      var _onUpdateArgs = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(_ref5) {\n        var storyId, updatedArgs;\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                storyId = _ref5.storyId, updatedArgs = _ref5.updatedArgs;\n\n                _get(_getPrototypeOf(PreviewWeb.prototype), \"onUpdateArgs\", this).call(this, {\n                  storyId: storyId,\n                  updatedArgs: updatedArgs\n                }); // NOTE: we aren't checking to see the story args are targetted at the \"right\" story.\n                // This is because we may render >1 story on the page and there is no easy way to keep track\n                // of which ones were rendered by the docs page.\n                // However, in `modernInlineRender`, the individual stories track their own events as they\n                // each call `renderStoryToElement` below.\n\n\n                if (!(this.currentRender instanceof DocsRender)) {\n                  _context6.next = 5;\n                  break;\n                }\n\n                _context6.next = 5;\n                return this.currentRender.rerender(false);\n\n              case 5:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function onUpdateArgs(_x4) {\n        return _onUpdateArgs.apply(this, arguments);\n      }\n\n      return onUpdateArgs;\n    }()\n  }, {\n    key: \"onPreloadStories\",\n    value: function () {\n      var _onPreloadStories = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(ids) {\n        var _this4 = this;\n\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return Promise.all(ids.map(function (id) {\n                  return _this4.storyStore.loadStory({\n                    storyId: id\n                  });\n                }));\n\n              case 2:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }));\n\n      function onPreloadStories(_x5) {\n        return _onPreloadStories.apply(this, arguments);\n      }\n\n      return onPreloadStories;\n    }() // RENDERING\n    // We can either have:\n    // - a story selected in \"story\" viewMode,\n    //     in which case we render it to the root element, OR\n    // - a story selected in \"docs\" viewMode,\n    //     in which case we render the docsPage for that story\n\n  }, {\n    key: \"renderSelection\",\n    value: function () {\n      var _renderSelection = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8() {\n        var _this$currentSelectio,\n            _this$currentSelectio2,\n            _lastRender,\n            _this5 = this,\n            _global$FEATURES3;\n\n        var _ref6,\n            persistedArgs,\n            selection,\n            storyId,\n            storyIdChanged,\n            viewModeChanged,\n            lastSelection,\n            lastRender,\n            storyRender,\n            implementationChanged,\n            _storyRender$context,\n            parameters,\n            initialArgs,\n            argTypes,\n            args,\n            _args8 = arguments;\n\n        return regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _ref6 = _args8.length > 0 && _args8[0] !== undefined ? _args8[0] : {}, persistedArgs = _ref6.persistedArgs;\n                selection = this.urlStore.selection;\n\n                if (selection) {\n                  _context8.next = 4;\n                  break;\n                }\n\n                throw new Error('Cannot render story as no selection was made');\n\n              case 4:\n                storyId = selection.storyId;\n                storyIdChanged = ((_this$currentSelectio = this.currentSelection) === null || _this$currentSelectio === void 0 ? void 0 : _this$currentSelectio.storyId) !== storyId;\n                viewModeChanged = ((_this$currentSelectio2 = this.currentSelection) === null || _this$currentSelectio2 === void 0 ? void 0 : _this$currentSelectio2.viewMode) !== selection.viewMode; // Show a spinner while we load the next story\n\n                if (selection.viewMode === 'story') {\n                  this.view.showPreparingStory({\n                    immediate: viewModeChanged\n                  });\n                } else {\n                  this.view.showPreparingDocs();\n                }\n\n                lastSelection = this.currentSelection;\n                lastRender = this.currentRender; // If the last render is still preparing, let's drop it right now. Either\n                //   (a) it is a different story, which means we would drop it later, OR\n                //   (b) it is the *same* story, in which case we will resolve our own .prepare() at the\n                //       same moment anyway, and we should just \"take over\" the rendering.\n                // (We can't tell which it is yet, because it is possible that an HMR is going on and\n                //  even though the storyId is the same, the story itself is not).\n\n                if (!((_lastRender = lastRender) !== null && _lastRender !== void 0 && _lastRender.isPreparing())) {\n                  _context8.next = 14;\n                  break;\n                }\n\n                _context8.next = 13;\n                return this.teardownRender(lastRender);\n\n              case 13:\n                lastRender = null;\n\n              case 14:\n                storyRender = new StoryRender(this.channel, this.storyStore, function () {\n                  // At the start of renderToDOM we make the story visible (see note in WebView)\n                  _this5.view.showStoryDuringRender();\n\n                  return _this5.renderToDOM.apply(_this5, arguments);\n                }, this.mainStoryCallbacks(storyId), storyId, 'story'); // We need to store this right away, so if the story changes during\n                // the async `.prepare()` below, we can (potentially) cancel it\n\n                this.currentSelection = selection; // Note this may be replaced by a docsRender after preparing\n\n                this.currentRender = storyRender;\n                _context8.prev = 17;\n                _context8.next = 20;\n                return storyRender.prepare();\n\n              case 20:\n                _context8.next = 29;\n                break;\n\n              case 22:\n                _context8.prev = 22;\n                _context8.t0 = _context8[\"catch\"](17);\n\n                if (!(_context8.t0 !== PREPARE_ABORTED)) {\n                  _context8.next = 28;\n                  break;\n                }\n\n                _context8.next = 27;\n                return this.teardownRender(lastRender);\n\n              case 27:\n                this.renderStoryLoadingException(storyId, _context8.t0);\n\n              case 28:\n                return _context8.abrupt(\"return\");\n\n              case 29:\n                implementationChanged = !storyIdChanged && !storyRender.isEqual(lastRender);\n                if (persistedArgs) this.storyStore.args.updateFromPersisted(storyRender.story, persistedArgs);\n                _storyRender$context = storyRender.context(), parameters = _storyRender$context.parameters, initialArgs = _storyRender$context.initialArgs, argTypes = _storyRender$context.argTypes, args = _storyRender$context.args; // Don't re-render the story if nothing has changed to justify it\n\n                if (!(lastRender && !storyIdChanged && !implementationChanged && !viewModeChanged)) {\n                  _context8.next = 37;\n                  break;\n                }\n\n                this.currentRender = lastRender;\n                this.channel.emit(STORY_UNCHANGED, storyId);\n                this.view.showMain();\n                return _context8.abrupt(\"return\");\n\n              case 37:\n                _context8.next = 39;\n                return this.teardownRender(lastRender, {\n                  viewModeChanged: viewModeChanged\n                });\n\n              case 39:\n                // If we are rendering something new (as opposed to re-rendering the same or first story), emit\n                if (lastSelection && (storyIdChanged || viewModeChanged)) {\n                  this.channel.emit(STORY_CHANGED, storyId);\n                }\n\n                if ((_global$FEATURES3 = global.FEATURES) !== null && _global$FEATURES3 !== void 0 && _global$FEATURES3.storyStoreV7) {\n                  this.channel.emit(STORY_PREPARED, {\n                    id: storyId,\n                    parameters: parameters,\n                    initialArgs: initialArgs,\n                    argTypes: argTypes,\n                    args: args\n                  });\n                } // For v6 mode / compatibility\n                // If the implementation changed, or args were persisted, the args may have changed,\n                // and the STORY_PREPARED event above may not be respected.\n\n\n                if (implementationChanged || persistedArgs) {\n                  this.channel.emit(STORY_ARGS_UPDATED, {\n                    storyId: storyId,\n                    args: args\n                  });\n                }\n\n                if (selection.viewMode === 'docs' || parameters.docsOnly) {\n                  this.currentRender = DocsRender.fromStoryRender(storyRender);\n                  this.currentRender.renderToElement(this.view.prepareForDocs(), this.renderStoryToElement.bind(this));\n                } else {\n                  this.storyRenders.push(storyRender);\n                  this.currentRender.renderToElement(this.view.prepareForStory(storyRender.story));\n                }\n\n              case 43:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this, [[17, 22]]);\n      }));\n\n      function renderSelection() {\n        return _renderSelection.apply(this, arguments);\n      }\n\n      return renderSelection;\n    }() // Used by docs' modernInlineRender to render a story to a given element\n    // Note this short-circuits the `prepare()` phase of the StoryRender,\n    // main to be consistent with the previous behaviour. In the future,\n    // we will change it to go ahead and load the story, which will end up being\n    // \"instant\", although async.\n\n  }, {\n    key: \"renderStoryToElement\",\n    value: function renderStoryToElement(story, element) {\n      var _this6 = this;\n\n      var render = new StoryRender(this.channel, this.storyStore, this.renderToDOM, this.inlineStoryCallbacks(story.id), story.id, 'docs', story);\n      render.renderToElement(element);\n      this.storyRenders.push(render);\n      return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9() {\n        return regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return _this6.teardownRender(render);\n\n              case 2:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }));\n    }\n  }, {\n    key: \"teardownRender\",\n    value: function () {\n      var _teardownRender = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10(render) {\n        var _ref8,\n            viewModeChanged,\n            _args10 = arguments;\n\n        return regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _ref8 = _args10.length > 1 && _args10[1] !== undefined ? _args10[1] : {}, viewModeChanged = _ref8.viewModeChanged;\n                this.storyRenders = this.storyRenders.filter(function (r) {\n                  return r !== render;\n                });\n                _context10.next = 4;\n                return render === null || render === void 0 ? void 0 : render.teardown({\n                  viewModeChanged: viewModeChanged\n                });\n\n              case 4:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function teardownRender(_x6) {\n        return _teardownRender.apply(this, arguments);\n      }\n\n      return teardownRender;\n    }() // API\n\n  }, {\n    key: \"extract\",\n    value: function () {\n      var _extract = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11(options) {\n        var _global$FEATURES4;\n\n        return regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                if (!this.previewEntryError) {\n                  _context11.next = 2;\n                  break;\n                }\n\n                throw this.previewEntryError;\n\n              case 2:\n                if (this.storyStore.projectAnnotations) {\n                  _context11.next = 4;\n                  break;\n                }\n\n                throw new Error(dedent(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your `preview.js`? Check your Storybook's browser console for errors.\"], [\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your \\\\`preview.js\\\\`? Check your Storybook's browser console for errors.\"]))));\n\n              case 4:\n                if (!((_global$FEATURES4 = global.FEATURES) !== null && _global$FEATURES4 !== void 0 && _global$FEATURES4.storyStoreV7)) {\n                  _context11.next = 7;\n                  break;\n                }\n\n                _context11.next = 7;\n                return this.storyStore.cacheAllCSFFiles();\n\n              case 7:\n                return _context11.abrupt(\"return\", this.storyStore.extract(options));\n\n              case 8:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n\n      function extract(_x7) {\n        return _extract.apply(this, arguments);\n      }\n\n      return extract;\n    }() // UTILITIES\n\n  }, {\n    key: \"mainStoryCallbacks\",\n    value: function mainStoryCallbacks(storyId) {\n      var _this7 = this;\n\n      return {\n        showMain: function showMain() {\n          return _this7.view.showMain();\n        },\n        showError: function showError(err) {\n          return _this7.renderError(storyId, err);\n        },\n        showException: function showException(err) {\n          return _this7.renderException(storyId, err);\n        }\n      };\n    }\n  }, {\n    key: \"inlineStoryCallbacks\",\n    value: function inlineStoryCallbacks(storyId) {\n      return {\n        showMain: function showMain() {},\n        showError: function showError(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        },\n        showException: function showException(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        }\n      };\n    }\n  }, {\n    key: \"renderPreviewEntryError\",\n    value: function renderPreviewEntryError(reason, err) {\n      _get(_getPrototypeOf(PreviewWeb.prototype), \"renderPreviewEntryError\", this).call(this, reason, err);\n\n      this.view.showErrorDisplay(err);\n    }\n  }, {\n    key: \"renderMissingStory\",\n    value: function renderMissingStory() {\n      this.view.showNoPreview();\n      this.channel.emit(STORY_MISSING);\n    }\n  }, {\n    key: \"renderStoryLoadingException\",\n    value: function renderStoryLoadingException(storySpecifier, err) {\n      logger.error(\"Unable to load story '\".concat(storySpecifier, \"':\"));\n      logger.error(err);\n      this.view.showErrorDisplay(err);\n      this.channel.emit(STORY_MISSING, storySpecifier);\n    } // renderException is used if we fail to render the story and it is uncaught by the app layer\n\n  }, {\n    key: \"renderException\",\n    value: function renderException(storyId, err) {\n      this.channel.emit(STORY_THREW_EXCEPTION, err);\n      this.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n        newPhase: 'errored',\n        storyId: storyId\n      }); // Ignored exceptions exist for control flow purposes, and are typically handled elsewhere.\n\n      if (err !== IGNORED_EXCEPTION) {\n        this.view.showErrorDisplay(err);\n        logger.error(\"Error rendering story '\".concat(storyId, \"':\"));\n        logger.error(err);\n      }\n    } // renderError is used by the various app layers to inform the user they have done something\n    // wrong -- for instance returned the wrong thing from a story\n\n  }, {\n    key: \"renderError\",\n    value: function renderError(storyId, _ref9) {\n      var title = _ref9.title,\n          description = _ref9.description;\n      logger.error(\"Error rendering story \".concat(title, \": \").concat(description));\n      this.channel.emit(STORY_ERRORED, {\n        title: title,\n        description: description\n      });\n      this.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n        newPhase: 'errored',\n        storyId: storyId\n      });\n      this.view.showErrorDisplay({\n        message: title,\n        stack: description\n      });\n    }\n  }]);\n\n  return PreviewWeb;\n}(Preview);"],"mappings":"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"},"metadata":{},"sourceType":"module"}