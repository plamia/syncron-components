{"ast":null,"code":"import _regeneratorRuntime from \"/Users/plamenakichukova/syncron-sdk-components/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/regenerator/index.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.freeze.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\n\nvar _templateObject, _templateObject2;\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nimport \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport dedent from 'ts-dedent';\nimport global from 'global';\nimport { SynchronousPromise } from 'synchronous-promise';\nimport { CONFIG_ERROR, FORCE_REMOUNT, FORCE_RE_RENDER, GLOBALS_UPDATED, RESET_STORY_ARGS, SET_GLOBALS, STORY_ARGS_UPDATED, STORY_INDEX_INVALIDATED, UPDATE_GLOBALS, UPDATE_STORY_ARGS } from '@storybook/core-events';\nimport { logger } from '@storybook/client-logger';\nimport { addons } from '@storybook/addons';\nimport { StoryStore } from '@storybook/store';\nimport { StoryRender } from './StoryRender';\nvar fetch = global.fetch;\nvar STORY_INDEX_PATH = './stories.json';\nexport var Preview = /*#__PURE__*/function () {\n  function Preview() {\n    var _global$FEATURES;\n\n    _classCallCheck(this, Preview);\n\n    this.channel = void 0;\n    this.serverChannel = void 0;\n    this.storyStore = void 0;\n    this.getStoryIndex = void 0;\n    this.importFn = void 0;\n    this.renderToDOM = void 0;\n    this.storyRenders = [];\n    this.previewEntryError = void 0;\n    this.channel = addons.getChannel();\n\n    if ((_global$FEATURES = global.FEATURES) !== null && _global$FEATURES !== void 0 && _global$FEATURES.storyStoreV7 && addons.hasServerChannel()) {\n      this.serverChannel = addons.getServerChannel();\n    }\n\n    this.storyStore = new StoryStore();\n  } // INITIALIZATION\n  // NOTE: the reason that the preview and store's initialization code is written in a promise\n  // style and not `async-await`, and the use of `SynchronousPromise`s is in order to allow\n  // storyshots to immediately call `raw()` on the store without waiting for a later tick.\n  // (Even simple things like `Promise.resolve()` and `await` involve the callback happening\n  // in the next promise \"tick\").\n  // See the comment in `storyshots-core/src/api/index.ts` for more detail.\n\n\n  _createClass(Preview, [{\n    key: \"initialize\",\n    value: function initialize(_ref) {\n      var _this = this;\n\n      var getStoryIndex = _ref.getStoryIndex,\n          importFn = _ref.importFn,\n          getProjectAnnotations = _ref.getProjectAnnotations; // We save these two on initialization in case `getProjectAnnotations` errors,\n      // in which case we may need them later when we recover.\n\n      this.getStoryIndex = getStoryIndex;\n      this.importFn = importFn;\n      this.setupListeners();\n      return this.getProjectAnnotationsOrRenderError(getProjectAnnotations).then(function (projectAnnotations) {\n        return _this.initializeWithProjectAnnotations(projectAnnotations);\n      });\n    }\n  }, {\n    key: \"setupListeners\",\n    value: function setupListeners() {\n      var _this$serverChannel;\n\n      (_this$serverChannel = this.serverChannel) === null || _this$serverChannel === void 0 ? void 0 : _this$serverChannel.on(STORY_INDEX_INVALIDATED, this.onStoryIndexChanged.bind(this));\n      this.channel.on(UPDATE_GLOBALS, this.onUpdateGlobals.bind(this));\n      this.channel.on(UPDATE_STORY_ARGS, this.onUpdateArgs.bind(this));\n      this.channel.on(RESET_STORY_ARGS, this.onResetArgs.bind(this));\n      this.channel.on(FORCE_RE_RENDER, this.onForceReRender.bind(this));\n      this.channel.on(FORCE_REMOUNT, this.onForceRemount.bind(this));\n    }\n  }, {\n    key: \"getProjectAnnotationsOrRenderError\",\n    value: function getProjectAnnotationsOrRenderError(getProjectAnnotations) {\n      var _this2 = this;\n\n      return SynchronousPromise.resolve().then(getProjectAnnotations).then(function (projectAnnotations) {\n        _this2.renderToDOM = projectAnnotations.renderToDOM;\n\n        if (!_this2.renderToDOM) {\n          throw new Error(dedent(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n            Expected your framework's preset to export a `renderToDOM` field.\\n\\n            Perhaps it needs to be upgraded for Storybook 6.4?\\n\\n            More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#mainjs-framework-field          \\n          \"], [\"\\n            Expected your framework's preset to export a \\\\`renderToDOM\\\\` field.\\n\\n            Perhaps it needs to be upgraded for Storybook 6.4?\\n\\n            More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#mainjs-framework-field          \\n          \"]))));\n        }\n\n        return projectAnnotations;\n      }).catch(function (err) {\n        // This is an error extracting the projectAnnotations (i.e. evaluating the previewEntries) and\n        // needs to be show to the user as a simple error\n        _this2.renderPreviewEntryError('Error reading preview.js:', err);\n\n        throw err;\n      });\n    } // If initialization gets as far as project annotations, this function runs.\n\n  }, {\n    key: \"initializeWithProjectAnnotations\",\n    value: function initializeWithProjectAnnotations(projectAnnotations) {\n      var _global$FEATURES2,\n          _this3 = this;\n\n      this.storyStore.setProjectAnnotations(projectAnnotations);\n      this.setInitialGlobals();\n      var storyIndexPromise;\n\n      if ((_global$FEATURES2 = global.FEATURES) !== null && _global$FEATURES2 !== void 0 && _global$FEATURES2.storyStoreV7) {\n        storyIndexPromise = this.getStoryIndexFromServer();\n      } else {\n        if (!this.getStoryIndex) {\n          throw new Error('No `getStoryIndex` passed defined in v6 mode');\n        }\n\n        storyIndexPromise = SynchronousPromise.resolve().then(this.getStoryIndex);\n      }\n\n      return storyIndexPromise.then(function (storyIndex) {\n        return _this3.initializeWithStoryIndex(storyIndex);\n      }).catch(function (err) {\n        _this3.renderPreviewEntryError('Error loading story index:', err);\n\n        throw err;\n      });\n    }\n  }, {\n    key: \"setInitialGlobals\",\n    value: function () {\n      var _setInitialGlobals = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.emitGlobals();\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function setInitialGlobals() {\n        return _setInitialGlobals.apply(this, arguments);\n      }\n\n      return setInitialGlobals;\n    }()\n  }, {\n    key: \"emitGlobals\",\n    value: function emitGlobals() {\n      this.channel.emit(SET_GLOBALS, {\n        globals: this.storyStore.globals.get() || {},\n        globalTypes: this.storyStore.projectAnnotations.globalTypes || {}\n      });\n    }\n  }, {\n    key: \"getStoryIndexFromServer\",\n    value: function () {\n      var _getStoryIndexFromServer = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var result;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return fetch(STORY_INDEX_PATH);\n\n              case 2:\n                result = _context2.sent;\n\n                if (!(result.status === 200)) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", result.json());\n\n              case 5:\n                _context2.t0 = Error;\n                _context2.next = 8;\n                return result.text();\n\n              case 8:\n                _context2.t1 = _context2.sent;\n                throw new _context2.t0(_context2.t1);\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function getStoryIndexFromServer() {\n        return _getStoryIndexFromServer.apply(this, arguments);\n      }\n\n      return getStoryIndexFromServer;\n    }() // If initialization gets as far as the story index, this function runs.\n\n  }, {\n    key: \"initializeWithStoryIndex\",\n    value: function initializeWithStoryIndex(storyIndex) {\n      var _global$FEATURES3;\n\n      return this.storyStore.initialize({\n        storyIndex: storyIndex,\n        importFn: this.importFn,\n        cache: !((_global$FEATURES3 = global.FEATURES) !== null && _global$FEATURES3 !== void 0 && _global$FEATURES3.storyStoreV7)\n      });\n    } // EVENT HANDLERS\n    // This happens when a config file gets reloaded\n\n  }, {\n    key: \"onGetProjectAnnotationsChanged\",\n    value: function () {\n      var _onGetProjectAnnotationsChanged = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref2) {\n        var getProjectAnnotations, projectAnnotations;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                getProjectAnnotations = _ref2.getProjectAnnotations;\n                delete this.previewEntryError;\n                _context3.next = 4;\n                return this.getProjectAnnotationsOrRenderError(getProjectAnnotations);\n\n              case 4:\n                projectAnnotations = _context3.sent;\n\n                if (this.storyStore.projectAnnotations) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                _context3.next = 8;\n                return this.initializeWithProjectAnnotations(projectAnnotations);\n\n              case 8:\n                return _context3.abrupt(\"return\");\n\n              case 9:\n                _context3.next = 11;\n                return this.storyStore.setProjectAnnotations(projectAnnotations);\n\n              case 11:\n                this.emitGlobals();\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function onGetProjectAnnotationsChanged(_x) {\n        return _onGetProjectAnnotationsChanged.apply(this, arguments);\n      }\n\n      return onGetProjectAnnotationsChanged;\n    }()\n  }, {\n    key: \"onStoryIndexChanged\",\n    value: function () {\n      var _onStoryIndexChanged = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var storyIndex;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                delete this.previewEntryError;\n\n                if (this.storyStore.projectAnnotations) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\");\n\n              case 3:\n                _context4.prev = 3;\n                _context4.next = 6;\n                return this.getStoryIndexFromServer();\n\n              case 6:\n                storyIndex = _context4.sent;\n\n                if (this.storyStore.storyIndex) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                _context4.next = 10;\n                return this.initializeWithStoryIndex(storyIndex);\n\n              case 10:\n                _context4.next = 12;\n                return this.onStoriesChanged({\n                  storyIndex: storyIndex\n                });\n\n              case 12:\n                _context4.next = 18;\n                break;\n\n              case 14:\n                _context4.prev = 14;\n                _context4.t0 = _context4[\"catch\"](3);\n                this.renderPreviewEntryError('Error loading story index:', _context4.t0);\n                throw _context4.t0;\n\n              case 18:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[3, 14]]);\n      }));\n\n      function onStoryIndexChanged() {\n        return _onStoryIndexChanged.apply(this, arguments);\n      }\n\n      return onStoryIndexChanged;\n    }() // This happens when a glob gets HMR-ed\n\n  }, {\n    key: \"onStoriesChanged\",\n    value: function () {\n      var _onStoriesChanged = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(_ref3) {\n        var importFn, storyIndex;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                importFn = _ref3.importFn, storyIndex = _ref3.storyIndex;\n                _context5.next = 3;\n                return this.storyStore.onStoriesChanged({\n                  importFn: importFn,\n                  storyIndex: storyIndex\n                });\n\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function onStoriesChanged(_x2) {\n        return _onStoriesChanged.apply(this, arguments);\n      }\n\n      return onStoriesChanged;\n    }()\n  }, {\n    key: \"onUpdateGlobals\",\n    value: function () {\n      var _onUpdateGlobals = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(_ref4) {\n        var globals;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                globals = _ref4.globals;\n                this.storyStore.globals.update(globals);\n                _context6.next = 4;\n                return Promise.all(this.storyRenders.map(function (r) {\n                  return r.rerender();\n                }));\n\n              case 4:\n                this.channel.emit(GLOBALS_UPDATED, {\n                  globals: this.storyStore.globals.get(),\n                  initialGlobals: this.storyStore.globals.initialGlobals\n                });\n\n              case 5:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function onUpdateGlobals(_x3) {\n        return _onUpdateGlobals.apply(this, arguments);\n      }\n\n      return onUpdateGlobals;\n    }()\n  }, {\n    key: \"onUpdateArgs\",\n    value: function () {\n      var _onUpdateArgs = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(_ref5) {\n        var storyId, updatedArgs;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                storyId = _ref5.storyId, updatedArgs = _ref5.updatedArgs;\n                this.storyStore.args.update(storyId, updatedArgs);\n                _context7.next = 4;\n                return Promise.all(this.storyRenders.filter(function (r) {\n                  return r.id === storyId;\n                }).map(function (r) {\n                  return r.rerender();\n                }));\n\n              case 4:\n                this.channel.emit(STORY_ARGS_UPDATED, {\n                  storyId: storyId,\n                  args: this.storyStore.args.get(storyId)\n                });\n\n              case 5:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function onUpdateArgs(_x4) {\n        return _onUpdateArgs.apply(this, arguments);\n      }\n\n      return onUpdateArgs;\n    }()\n  }, {\n    key: \"onResetArgs\",\n    value: function () {\n      var _onResetArgs = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(_ref6) {\n        var storyId, argNames, render, story, argNamesToReset, updatedArgs;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                storyId = _ref6.storyId, argNames = _ref6.argNames; // NOTE: we have to be careful here and avoid await-ing when updating a rendered's args.\n                // That's because below in `renderStoryToElement` we have also bound to this event and will\n                // render the story in the same tick.\n                // However, we can do that safely as the current story is available in `this.storyRenders`\n\n                render = this.storyRenders.find(function (r) {\n                  return r.id === storyId;\n                });\n                _context8.t0 = render === null || render === void 0 ? void 0 : render.story;\n\n                if (_context8.t0) {\n                  _context8.next = 7;\n                  break;\n                }\n\n                _context8.next = 6;\n                return this.storyStore.loadStory({\n                  storyId: storyId\n                });\n\n              case 6:\n                _context8.t0 = _context8.sent;\n\n              case 7:\n                story = _context8.t0;\n                argNamesToReset = argNames || _toConsumableArray(new Set([].concat(_toConsumableArray(Object.keys(story.initialArgs)), _toConsumableArray(Object.keys(this.storyStore.args.get(storyId))))));\n                updatedArgs = argNamesToReset.reduce(function (acc, argName) {\n                  acc[argName] = story.initialArgs[argName];\n                  return acc;\n                }, {});\n                _context8.next = 12;\n                return this.onUpdateArgs({\n                  storyId: storyId,\n                  updatedArgs: updatedArgs\n                });\n\n              case 12:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function onResetArgs(_x5) {\n        return _onResetArgs.apply(this, arguments);\n      }\n\n      return onResetArgs;\n    }() // ForceReRender does not include a story id, so we simply must\n    // re-render all stories in case they are relevant\n\n  }, {\n    key: \"onForceReRender\",\n    value: function () {\n      var _onForceReRender = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return Promise.all(this.storyRenders.map(function (r) {\n                  return r.rerender();\n                }));\n\n              case 2:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function onForceReRender() {\n        return _onForceReRender.apply(this, arguments);\n      }\n\n      return onForceReRender;\n    }()\n  }, {\n    key: \"onForceRemount\",\n    value: function () {\n      var _onForceRemount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10(_ref7) {\n        var storyId;\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                storyId = _ref7.storyId;\n                _context10.next = 3;\n                return Promise.all(this.storyRenders.filter(function (r) {\n                  return r.id === storyId;\n                }).map(function (r) {\n                  return r.remount();\n                }));\n\n              case 3:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function onForceRemount(_x6) {\n        return _onForceRemount.apply(this, arguments);\n      }\n\n      return onForceRemount;\n    }() // Used by docs' modernInlineRender to render a story to a given element\n    // Note this short-circuits the `prepare()` phase of the StoryRender,\n    // main to be consistent with the previous behaviour. In the future,\n    // we will change it to go ahead and load the story, which will end up being\n    // \"instant\", although async.\n\n  }, {\n    key: \"renderStoryToElement\",\n    value: function renderStoryToElement(story, element) {\n      var _this4 = this;\n\n      var render = new StoryRender(this.channel, this.storyStore, this.renderToDOM, this.inlineStoryCallbacks(story.id), story.id, 'docs', story);\n      render.renderToElement(element);\n      this.storyRenders.push(render);\n      return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11() {\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return _this4.teardownRender(render);\n\n              case 2:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11);\n      }));\n    }\n  }, {\n    key: \"teardownRender\",\n    value: function () {\n      var _teardownRender = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12(render) {\n        var _ref9,\n            viewModeChanged,\n            _args12 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                _ref9 = _args12.length > 1 && _args12[1] !== undefined ? _args12[1] : {}, viewModeChanged = _ref9.viewModeChanged;\n                this.storyRenders = this.storyRenders.filter(function (r) {\n                  return r !== render;\n                });\n                _context12.next = 4;\n                return render === null || render === void 0 ? void 0 : render.teardown({\n                  viewModeChanged: viewModeChanged\n                });\n\n              case 4:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function teardownRender(_x7) {\n        return _teardownRender.apply(this, arguments);\n      }\n\n      return teardownRender;\n    }() // API\n\n  }, {\n    key: \"extract\",\n    value: function () {\n      var _extract = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13(options) {\n        var _global$FEATURES4;\n\n        return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                if (!this.previewEntryError) {\n                  _context13.next = 2;\n                  break;\n                }\n\n                throw this.previewEntryError;\n\n              case 2:\n                if (this.storyStore.projectAnnotations) {\n                  _context13.next = 4;\n                  break;\n                }\n\n                throw new Error(dedent(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your `preview.js`? Check your Storybook's browser console for errors.\"], [\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your \\\\`preview.js\\\\`? Check your Storybook's browser console for errors.\"]))));\n\n              case 4:\n                if (!((_global$FEATURES4 = global.FEATURES) !== null && _global$FEATURES4 !== void 0 && _global$FEATURES4.storyStoreV7)) {\n                  _context13.next = 7;\n                  break;\n                }\n\n                _context13.next = 7;\n                return this.storyStore.cacheAllCSFFiles();\n\n              case 7:\n                return _context13.abrupt(\"return\", this.storyStore.extract(options));\n\n              case 8:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13, this);\n      }));\n\n      function extract(_x8) {\n        return _extract.apply(this, arguments);\n      }\n\n      return extract;\n    }() // UTILITIES\n\n  }, {\n    key: \"inlineStoryCallbacks\",\n    value: function inlineStoryCallbacks(storyId) {\n      return {\n        showMain: function showMain() {},\n        showError: function showError(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        },\n        showException: function showException(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        }\n      };\n    }\n  }, {\n    key: \"renderPreviewEntryError\",\n    value: function renderPreviewEntryError(reason, err) {\n      this.previewEntryError = err;\n      logger.error(reason);\n      logger.error(err);\n      this.channel.emit(CONFIG_ERROR, err);\n    }\n  }]);\n\n  return Preview;\n}();","map":{"version":3,"names":["_templateObject","_templateObject2","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_taggedTemplateLiteral","strings","raw","freeze","defineProperties","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","_createClass","protoProps","staticProps","dedent","global","SynchronousPromise","CONFIG_ERROR","FORCE_REMOUNT","FORCE_RE_RENDER","GLOBALS_UPDATED","RESET_STORY_ARGS","SET_GLOBALS","STORY_ARGS_UPDATED","STORY_INDEX_INVALIDATED","UPDATE_GLOBALS","UPDATE_STORY_ARGS","logger","addons","StoryStore","StoryRender","fetch","STORY_INDEX_PATH","Preview","_global$FEATURES","channel","serverChannel","storyStore","getStoryIndex","importFn","renderToDOM","storyRenders","previewEntryError","getChannel","FEATURES","storyStoreV7","hasServerChannel","getServerChannel","initialize","_ref","_this","getProjectAnnotations","setupListeners","getProjectAnnotationsOrRenderError","projectAnnotations","initializeWithProjectAnnotations","_this$serverChannel","on","onStoryIndexChanged","bind","onUpdateGlobals","onUpdateArgs","onResetArgs","onForceReRender","onForceRemount","_this2","Error","catch","renderPreviewEntryError","_global$FEATURES2","_this3","setProjectAnnotations","setInitialGlobals","storyIndexPromise","getStoryIndexFromServer","storyIndex","initializeWithStoryIndex","_setInitialGlobals","mark","_callee","wrap","_callee$","_context","prev","next","emitGlobals","stop","emit","globals","get","globalTypes","_getStoryIndexFromServer","_callee2","result","_callee2$","_context2","sent","status","abrupt","json","t0","text","t1","_global$FEATURES3","cache","_onGetProjectAnnotationsChanged","_callee3","_ref2","_callee3$","_context3","onGetProjectAnnotationsChanged","_x","_onStoryIndexChanged","_callee4","_callee4$","_context4","onStoriesChanged","_onStoriesChanged","_callee5","_ref3","_callee5$","_context5","_x2","_onUpdateGlobals","_callee6","_ref4","_callee6$","_context6","update","all","map","r","rerender","initialGlobals","_x3","_onUpdateArgs","_callee7","_ref5","storyId","updatedArgs","_callee7$","_context7","filter","id","_x4","_onResetArgs","_callee8","_ref6","argNames","render","story","argNamesToReset","_callee8$","_context8","find","loadStory","Set","concat","keys","initialArgs","reduce","acc","argName","_x5","_onForceReRender","_callee9","_callee9$","_context9","_onForceRemount","_callee10","_ref7","_callee10$","_context10","remount","_x6","renderStoryToElement","element","_this4","inlineStoryCallbacks","renderToElement","push","_callee11","_callee11$","_context11","teardownRender","_teardownRender","_callee12","_ref9","viewModeChanged","_args12","_callee12$","_context12","teardown","_x7","_extract","_callee13","options","_global$FEATURES4","_callee13$","_context13","cacheAllCSFFiles","extract","_x8","showMain","showError","showException","reason"],"sources":["/Users/plamenakichukova/syncron-sdk-components/node_modules/@storybook/preview-web/dist/esm/Preview.js"],"sourcesContent":["import \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.freeze.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\n\nvar _templateObject, _templateObject2;\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport dedent from 'ts-dedent';\nimport global from 'global';\nimport { SynchronousPromise } from 'synchronous-promise';\nimport { CONFIG_ERROR, FORCE_REMOUNT, FORCE_RE_RENDER, GLOBALS_UPDATED, RESET_STORY_ARGS, SET_GLOBALS, STORY_ARGS_UPDATED, STORY_INDEX_INVALIDATED, UPDATE_GLOBALS, UPDATE_STORY_ARGS } from '@storybook/core-events';\nimport { logger } from '@storybook/client-logger';\nimport { addons } from '@storybook/addons';\nimport { StoryStore } from '@storybook/store';\nimport { StoryRender } from './StoryRender';\nvar fetch = global.fetch;\nvar STORY_INDEX_PATH = './stories.json';\nexport var Preview = /*#__PURE__*/function () {\n  function Preview() {\n    var _global$FEATURES;\n\n    _classCallCheck(this, Preview);\n\n    this.channel = void 0;\n    this.serverChannel = void 0;\n    this.storyStore = void 0;\n    this.getStoryIndex = void 0;\n    this.importFn = void 0;\n    this.renderToDOM = void 0;\n    this.storyRenders = [];\n    this.previewEntryError = void 0;\n    this.channel = addons.getChannel();\n\n    if ((_global$FEATURES = global.FEATURES) !== null && _global$FEATURES !== void 0 && _global$FEATURES.storyStoreV7 && addons.hasServerChannel()) {\n      this.serverChannel = addons.getServerChannel();\n    }\n\n    this.storyStore = new StoryStore();\n  } // INITIALIZATION\n  // NOTE: the reason that the preview and store's initialization code is written in a promise\n  // style and not `async-await`, and the use of `SynchronousPromise`s is in order to allow\n  // storyshots to immediately call `raw()` on the store without waiting for a later tick.\n  // (Even simple things like `Promise.resolve()` and `await` involve the callback happening\n  // in the next promise \"tick\").\n  // See the comment in `storyshots-core/src/api/index.ts` for more detail.\n\n\n  _createClass(Preview, [{\n    key: \"initialize\",\n    value: function initialize(_ref) {\n      var _this = this;\n\n      var getStoryIndex = _ref.getStoryIndex,\n          importFn = _ref.importFn,\n          getProjectAnnotations = _ref.getProjectAnnotations;\n      // We save these two on initialization in case `getProjectAnnotations` errors,\n      // in which case we may need them later when we recover.\n      this.getStoryIndex = getStoryIndex;\n      this.importFn = importFn;\n      this.setupListeners();\n      return this.getProjectAnnotationsOrRenderError(getProjectAnnotations).then(function (projectAnnotations) {\n        return _this.initializeWithProjectAnnotations(projectAnnotations);\n      });\n    }\n  }, {\n    key: \"setupListeners\",\n    value: function setupListeners() {\n      var _this$serverChannel;\n\n      (_this$serverChannel = this.serverChannel) === null || _this$serverChannel === void 0 ? void 0 : _this$serverChannel.on(STORY_INDEX_INVALIDATED, this.onStoryIndexChanged.bind(this));\n      this.channel.on(UPDATE_GLOBALS, this.onUpdateGlobals.bind(this));\n      this.channel.on(UPDATE_STORY_ARGS, this.onUpdateArgs.bind(this));\n      this.channel.on(RESET_STORY_ARGS, this.onResetArgs.bind(this));\n      this.channel.on(FORCE_RE_RENDER, this.onForceReRender.bind(this));\n      this.channel.on(FORCE_REMOUNT, this.onForceRemount.bind(this));\n    }\n  }, {\n    key: \"getProjectAnnotationsOrRenderError\",\n    value: function getProjectAnnotationsOrRenderError(getProjectAnnotations) {\n      var _this2 = this;\n\n      return SynchronousPromise.resolve().then(getProjectAnnotations).then(function (projectAnnotations) {\n        _this2.renderToDOM = projectAnnotations.renderToDOM;\n\n        if (!_this2.renderToDOM) {\n          throw new Error(dedent(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n            Expected your framework's preset to export a `renderToDOM` field.\\n\\n            Perhaps it needs to be upgraded for Storybook 6.4?\\n\\n            More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#mainjs-framework-field          \\n          \"], [\"\\n            Expected your framework's preset to export a \\\\`renderToDOM\\\\` field.\\n\\n            Perhaps it needs to be upgraded for Storybook 6.4?\\n\\n            More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#mainjs-framework-field          \\n          \"]))));\n        }\n\n        return projectAnnotations;\n      }).catch(function (err) {\n        // This is an error extracting the projectAnnotations (i.e. evaluating the previewEntries) and\n        // needs to be show to the user as a simple error\n        _this2.renderPreviewEntryError('Error reading preview.js:', err);\n\n        throw err;\n      });\n    } // If initialization gets as far as project annotations, this function runs.\n\n  }, {\n    key: \"initializeWithProjectAnnotations\",\n    value: function initializeWithProjectAnnotations(projectAnnotations) {\n      var _global$FEATURES2,\n          _this3 = this;\n\n      this.storyStore.setProjectAnnotations(projectAnnotations);\n      this.setInitialGlobals();\n      var storyIndexPromise;\n\n      if ((_global$FEATURES2 = global.FEATURES) !== null && _global$FEATURES2 !== void 0 && _global$FEATURES2.storyStoreV7) {\n        storyIndexPromise = this.getStoryIndexFromServer();\n      } else {\n        if (!this.getStoryIndex) {\n          throw new Error('No `getStoryIndex` passed defined in v6 mode');\n        }\n\n        storyIndexPromise = SynchronousPromise.resolve().then(this.getStoryIndex);\n      }\n\n      return storyIndexPromise.then(function (storyIndex) {\n        return _this3.initializeWithStoryIndex(storyIndex);\n      }).catch(function (err) {\n        _this3.renderPreviewEntryError('Error loading story index:', err);\n\n        throw err;\n      });\n    }\n  }, {\n    key: \"setInitialGlobals\",\n    value: function () {\n      var _setInitialGlobals = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.emitGlobals();\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function setInitialGlobals() {\n        return _setInitialGlobals.apply(this, arguments);\n      }\n\n      return setInitialGlobals;\n    }()\n  }, {\n    key: \"emitGlobals\",\n    value: function emitGlobals() {\n      this.channel.emit(SET_GLOBALS, {\n        globals: this.storyStore.globals.get() || {},\n        globalTypes: this.storyStore.projectAnnotations.globalTypes || {}\n      });\n    }\n  }, {\n    key: \"getStoryIndexFromServer\",\n    value: function () {\n      var _getStoryIndexFromServer = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var result;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return fetch(STORY_INDEX_PATH);\n\n              case 2:\n                result = _context2.sent;\n\n                if (!(result.status === 200)) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", result.json());\n\n              case 5:\n                _context2.t0 = Error;\n                _context2.next = 8;\n                return result.text();\n\n              case 8:\n                _context2.t1 = _context2.sent;\n                throw new _context2.t0(_context2.t1);\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function getStoryIndexFromServer() {\n        return _getStoryIndexFromServer.apply(this, arguments);\n      }\n\n      return getStoryIndexFromServer;\n    }() // If initialization gets as far as the story index, this function runs.\n\n  }, {\n    key: \"initializeWithStoryIndex\",\n    value: function initializeWithStoryIndex(storyIndex) {\n      var _global$FEATURES3;\n\n      return this.storyStore.initialize({\n        storyIndex: storyIndex,\n        importFn: this.importFn,\n        cache: !((_global$FEATURES3 = global.FEATURES) !== null && _global$FEATURES3 !== void 0 && _global$FEATURES3.storyStoreV7)\n      });\n    } // EVENT HANDLERS\n    // This happens when a config file gets reloaded\n\n  }, {\n    key: \"onGetProjectAnnotationsChanged\",\n    value: function () {\n      var _onGetProjectAnnotationsChanged = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(_ref2) {\n        var getProjectAnnotations, projectAnnotations;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                getProjectAnnotations = _ref2.getProjectAnnotations;\n                delete this.previewEntryError;\n                _context3.next = 4;\n                return this.getProjectAnnotationsOrRenderError(getProjectAnnotations);\n\n              case 4:\n                projectAnnotations = _context3.sent;\n\n                if (this.storyStore.projectAnnotations) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                _context3.next = 8;\n                return this.initializeWithProjectAnnotations(projectAnnotations);\n\n              case 8:\n                return _context3.abrupt(\"return\");\n\n              case 9:\n                _context3.next = 11;\n                return this.storyStore.setProjectAnnotations(projectAnnotations);\n\n              case 11:\n                this.emitGlobals();\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function onGetProjectAnnotationsChanged(_x) {\n        return _onGetProjectAnnotationsChanged.apply(this, arguments);\n      }\n\n      return onGetProjectAnnotationsChanged;\n    }()\n  }, {\n    key: \"onStoryIndexChanged\",\n    value: function () {\n      var _onStoryIndexChanged = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n        var storyIndex;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                delete this.previewEntryError;\n\n                if (this.storyStore.projectAnnotations) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\");\n\n              case 3:\n                _context4.prev = 3;\n                _context4.next = 6;\n                return this.getStoryIndexFromServer();\n\n              case 6:\n                storyIndex = _context4.sent;\n\n                if (this.storyStore.storyIndex) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                _context4.next = 10;\n                return this.initializeWithStoryIndex(storyIndex);\n\n              case 10:\n                _context4.next = 12;\n                return this.onStoriesChanged({\n                  storyIndex: storyIndex\n                });\n\n              case 12:\n                _context4.next = 18;\n                break;\n\n              case 14:\n                _context4.prev = 14;\n                _context4.t0 = _context4[\"catch\"](3);\n                this.renderPreviewEntryError('Error loading story index:', _context4.t0);\n                throw _context4.t0;\n\n              case 18:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[3, 14]]);\n      }));\n\n      function onStoryIndexChanged() {\n        return _onStoryIndexChanged.apply(this, arguments);\n      }\n\n      return onStoryIndexChanged;\n    }() // This happens when a glob gets HMR-ed\n\n  }, {\n    key: \"onStoriesChanged\",\n    value: function () {\n      var _onStoriesChanged = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(_ref3) {\n        var importFn, storyIndex;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                importFn = _ref3.importFn, storyIndex = _ref3.storyIndex;\n                _context5.next = 3;\n                return this.storyStore.onStoriesChanged({\n                  importFn: importFn,\n                  storyIndex: storyIndex\n                });\n\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function onStoriesChanged(_x2) {\n        return _onStoriesChanged.apply(this, arguments);\n      }\n\n      return onStoriesChanged;\n    }()\n  }, {\n    key: \"onUpdateGlobals\",\n    value: function () {\n      var _onUpdateGlobals = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(_ref4) {\n        var globals;\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                globals = _ref4.globals;\n                this.storyStore.globals.update(globals);\n                _context6.next = 4;\n                return Promise.all(this.storyRenders.map(function (r) {\n                  return r.rerender();\n                }));\n\n              case 4:\n                this.channel.emit(GLOBALS_UPDATED, {\n                  globals: this.storyStore.globals.get(),\n                  initialGlobals: this.storyStore.globals.initialGlobals\n                });\n\n              case 5:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function onUpdateGlobals(_x3) {\n        return _onUpdateGlobals.apply(this, arguments);\n      }\n\n      return onUpdateGlobals;\n    }()\n  }, {\n    key: \"onUpdateArgs\",\n    value: function () {\n      var _onUpdateArgs = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(_ref5) {\n        var storyId, updatedArgs;\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                storyId = _ref5.storyId, updatedArgs = _ref5.updatedArgs;\n                this.storyStore.args.update(storyId, updatedArgs);\n                _context7.next = 4;\n                return Promise.all(this.storyRenders.filter(function (r) {\n                  return r.id === storyId;\n                }).map(function (r) {\n                  return r.rerender();\n                }));\n\n              case 4:\n                this.channel.emit(STORY_ARGS_UPDATED, {\n                  storyId: storyId,\n                  args: this.storyStore.args.get(storyId)\n                });\n\n              case 5:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function onUpdateArgs(_x4) {\n        return _onUpdateArgs.apply(this, arguments);\n      }\n\n      return onUpdateArgs;\n    }()\n  }, {\n    key: \"onResetArgs\",\n    value: function () {\n      var _onResetArgs = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(_ref6) {\n        var storyId, argNames, render, story, argNamesToReset, updatedArgs;\n        return regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                storyId = _ref6.storyId, argNames = _ref6.argNames;\n                // NOTE: we have to be careful here and avoid await-ing when updating a rendered's args.\n                // That's because below in `renderStoryToElement` we have also bound to this event and will\n                // render the story in the same tick.\n                // However, we can do that safely as the current story is available in `this.storyRenders`\n                render = this.storyRenders.find(function (r) {\n                  return r.id === storyId;\n                });\n                _context8.t0 = render === null || render === void 0 ? void 0 : render.story;\n\n                if (_context8.t0) {\n                  _context8.next = 7;\n                  break;\n                }\n\n                _context8.next = 6;\n                return this.storyStore.loadStory({\n                  storyId: storyId\n                });\n\n              case 6:\n                _context8.t0 = _context8.sent;\n\n              case 7:\n                story = _context8.t0;\n                argNamesToReset = argNames || _toConsumableArray(new Set([].concat(_toConsumableArray(Object.keys(story.initialArgs)), _toConsumableArray(Object.keys(this.storyStore.args.get(storyId))))));\n                updatedArgs = argNamesToReset.reduce(function (acc, argName) {\n                  acc[argName] = story.initialArgs[argName];\n                  return acc;\n                }, {});\n                _context8.next = 12;\n                return this.onUpdateArgs({\n                  storyId: storyId,\n                  updatedArgs: updatedArgs\n                });\n\n              case 12:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function onResetArgs(_x5) {\n        return _onResetArgs.apply(this, arguments);\n      }\n\n      return onResetArgs;\n    }() // ForceReRender does not include a story id, so we simply must\n    // re-render all stories in case they are relevant\n\n  }, {\n    key: \"onForceReRender\",\n    value: function () {\n      var _onForceReRender = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9() {\n        return regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return Promise.all(this.storyRenders.map(function (r) {\n                  return r.rerender();\n                }));\n\n              case 2:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function onForceReRender() {\n        return _onForceReRender.apply(this, arguments);\n      }\n\n      return onForceReRender;\n    }()\n  }, {\n    key: \"onForceRemount\",\n    value: function () {\n      var _onForceRemount = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10(_ref7) {\n        var storyId;\n        return regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                storyId = _ref7.storyId;\n                _context10.next = 3;\n                return Promise.all(this.storyRenders.filter(function (r) {\n                  return r.id === storyId;\n                }).map(function (r) {\n                  return r.remount();\n                }));\n\n              case 3:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function onForceRemount(_x6) {\n        return _onForceRemount.apply(this, arguments);\n      }\n\n      return onForceRemount;\n    }() // Used by docs' modernInlineRender to render a story to a given element\n    // Note this short-circuits the `prepare()` phase of the StoryRender,\n    // main to be consistent with the previous behaviour. In the future,\n    // we will change it to go ahead and load the story, which will end up being\n    // \"instant\", although async.\n\n  }, {\n    key: \"renderStoryToElement\",\n    value: function renderStoryToElement(story, element) {\n      var _this4 = this;\n\n      var render = new StoryRender(this.channel, this.storyStore, this.renderToDOM, this.inlineStoryCallbacks(story.id), story.id, 'docs', story);\n      render.renderToElement(element);\n      this.storyRenders.push(render);\n      return /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11() {\n        return regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return _this4.teardownRender(render);\n\n              case 2:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11);\n      }));\n    }\n  }, {\n    key: \"teardownRender\",\n    value: function () {\n      var _teardownRender = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12(render) {\n        var _ref9,\n            viewModeChanged,\n            _args12 = arguments;\n\n        return regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                _ref9 = _args12.length > 1 && _args12[1] !== undefined ? _args12[1] : {}, viewModeChanged = _ref9.viewModeChanged;\n                this.storyRenders = this.storyRenders.filter(function (r) {\n                  return r !== render;\n                });\n                _context12.next = 4;\n                return render === null || render === void 0 ? void 0 : render.teardown({\n                  viewModeChanged: viewModeChanged\n                });\n\n              case 4:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function teardownRender(_x7) {\n        return _teardownRender.apply(this, arguments);\n      }\n\n      return teardownRender;\n    }() // API\n\n  }, {\n    key: \"extract\",\n    value: function () {\n      var _extract = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee13(options) {\n        var _global$FEATURES4;\n\n        return regeneratorRuntime.wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                if (!this.previewEntryError) {\n                  _context13.next = 2;\n                  break;\n                }\n\n                throw this.previewEntryError;\n\n              case 2:\n                if (this.storyStore.projectAnnotations) {\n                  _context13.next = 4;\n                  break;\n                }\n\n                throw new Error(dedent(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your `preview.js`? Check your Storybook's browser console for errors.\"], [\"Failed to initialize Storybook.\\n      \\n      Do you have an error in your \\\\`preview.js\\\\`? Check your Storybook's browser console for errors.\"]))));\n\n              case 4:\n                if (!((_global$FEATURES4 = global.FEATURES) !== null && _global$FEATURES4 !== void 0 && _global$FEATURES4.storyStoreV7)) {\n                  _context13.next = 7;\n                  break;\n                }\n\n                _context13.next = 7;\n                return this.storyStore.cacheAllCSFFiles();\n\n              case 7:\n                return _context13.abrupt(\"return\", this.storyStore.extract(options));\n\n              case 8:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13, this);\n      }));\n\n      function extract(_x8) {\n        return _extract.apply(this, arguments);\n      }\n\n      return extract;\n    }() // UTILITIES\n\n  }, {\n    key: \"inlineStoryCallbacks\",\n    value: function inlineStoryCallbacks(storyId) {\n      return {\n        showMain: function showMain() {},\n        showError: function showError(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        },\n        showException: function showException(err) {\n          return logger.error(\"Error rendering docs story (\".concat(storyId, \")\"), err);\n        }\n      };\n    }\n  }, {\n    key: \"renderPreviewEntryError\",\n    value: function renderPreviewEntryError(reason, err) {\n      this.previewEntryError = err;\n      logger.error(reason);\n      logger.error(err);\n      this.channel.emit(CONFIG_ERROR, err);\n    }\n  }]);\n\n  return Preview;\n}();"],"mappings":"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"},"metadata":{},"sourceType":"module"}