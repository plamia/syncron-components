{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.clearRootHTMLElement = exports.getRenderType = exports.RendererFactory = void 0;\n\nconst AbstractRenderer_1 = require(\"./AbstractRenderer\");\n\nconst DocsRenderer_1 = require(\"./DocsRenderer\");\n\nconst CanvasRenderer_1 = require(\"./CanvasRenderer\");\n\nclass RendererFactory {\n  constructor() {\n    this.rendererMap = new Map();\n  }\n\n  getRendererInstance(storyId, targetDOMNode) {\n    return __awaiter(this, void 0, void 0, function* () {\n      // do nothing if the target node is null\n      // fix a problem when the docs asks 2 times the same component at the same time\n      // the 1st targetDOMNode of the 1st requested rendering becomes null 🤷‍♂️\n      if (targetDOMNode === null) {\n        return null;\n      }\n\n      const renderType = exports.getRenderType(targetDOMNode); // keep only instances of the same type\n\n      if (this.lastRenderType && this.lastRenderType !== renderType) {\n        yield AbstractRenderer_1.AbstractRenderer.resetPlatformBrowserDynamic();\n        clearRootHTMLElement(renderType);\n        this.rendererMap.clear();\n      }\n\n      if (!this.rendererMap.has(storyId)) {\n        this.rendererMap.set(storyId, this.buildRenderer(storyId, renderType));\n      }\n\n      this.lastRenderType = renderType;\n      return this.rendererMap.get(storyId);\n    });\n  }\n\n  buildRenderer(storyId, renderType) {\n    if (renderType === 'docs') {\n      return new DocsRenderer_1.DocsRenderer(storyId);\n    }\n\n    return new CanvasRenderer_1.CanvasRenderer(storyId);\n  }\n\n}\n\nexports.RendererFactory = RendererFactory;\n\nexports.getRenderType = targetDOMNode => {\n  return targetDOMNode.id === 'root' ? 'canvas' : 'docs';\n};\n\nfunction clearRootHTMLElement(renderType) {\n  switch (renderType) {\n    case 'canvas':\n      global.document.getElementById('docs-root').innerHTML = '';\n      break;\n\n    case 'docs':\n      global.document.getElementById('root').innerHTML = '';\n      break;\n\n    default:\n      break;\n  }\n}\n\nexports.clearRootHTMLElement = clearRootHTMLElement;","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","clearRootHTMLElement","getRenderType","RendererFactory","AbstractRenderer_1","require","DocsRenderer_1","CanvasRenderer_1","constructor","rendererMap","Map","getRendererInstance","storyId","targetDOMNode","renderType","lastRenderType","AbstractRenderer","resetPlatformBrowserDynamic","clear","has","set","buildRenderer","get","DocsRenderer","CanvasRenderer","id","global","document","getElementById","innerHTML"],"sources":["/Users/plamenakichukova/syncron-sdk-components/node_modules/@storybook/angular/dist/ts3.9/client/preview/angular-beta/RendererFactory.js"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.clearRootHTMLElement = exports.getRenderType = exports.RendererFactory = void 0;\nconst AbstractRenderer_1 = require(\"./AbstractRenderer\");\nconst DocsRenderer_1 = require(\"./DocsRenderer\");\nconst CanvasRenderer_1 = require(\"./CanvasRenderer\");\nclass RendererFactory {\n    constructor() {\n        this.rendererMap = new Map();\n    }\n    getRendererInstance(storyId, targetDOMNode) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // do nothing if the target node is null\n            // fix a problem when the docs asks 2 times the same component at the same time\n            // the 1st targetDOMNode of the 1st requested rendering becomes null 🤷‍♂️\n            if (targetDOMNode === null) {\n                return null;\n            }\n            const renderType = exports.getRenderType(targetDOMNode);\n            // keep only instances of the same type\n            if (this.lastRenderType && this.lastRenderType !== renderType) {\n                yield AbstractRenderer_1.AbstractRenderer.resetPlatformBrowserDynamic();\n                clearRootHTMLElement(renderType);\n                this.rendererMap.clear();\n            }\n            if (!this.rendererMap.has(storyId)) {\n                this.rendererMap.set(storyId, this.buildRenderer(storyId, renderType));\n            }\n            this.lastRenderType = renderType;\n            return this.rendererMap.get(storyId);\n        });\n    }\n    buildRenderer(storyId, renderType) {\n        if (renderType === 'docs') {\n            return new DocsRenderer_1.DocsRenderer(storyId);\n        }\n        return new CanvasRenderer_1.CanvasRenderer(storyId);\n    }\n}\nexports.RendererFactory = RendererFactory;\nexports.getRenderType = (targetDOMNode) => {\n    return targetDOMNode.id === 'root' ? 'canvas' : 'docs';\n};\nfunction clearRootHTMLElement(renderType) {\n    switch (renderType) {\n        case 'canvas':\n            global.document.getElementById('docs-root').innerHTML = '';\n            break;\n        case 'docs':\n            global.document.getElementById('root').innerHTML = '';\n            break;\n        default:\n            break;\n    }\n}\nexports.clearRootHTMLElement = clearRootHTMLElement;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}